<!DOCTYPE html>
<html lang="en" class="bg-gray-100">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Register - CareerGenius</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://kit.fontawesome.com/a2a93b7abc.js" crossorigin="anonymous"></script>
  <style>
    .auth-transition {
      transition: all 0.3s ease-in-out;
    }
    .password-toggle {
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
    }
    .eye-icon {
      font-size: 1rem;
    }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 relative">

  <!-- Logo -->
  <div class="absolute top-6 left-6 md:top-10 md:left-10">
    <div class="flex items-center">
      <div class="w-8 h-8 bg-blue-600 rounded-md flex items-center justify-center text-white font-bold">CG</div>
      <span class="ml-2 font-bold text-lg">Career<span class="text-blue-600">Genius</span></span>
    </div>
  </div>

  <!-- Main Auth Container -->
  <div class="w-full max-w-md bg-white shadow-xl rounded-xl overflow-hidden" id="authContainer">
    <div class="relative auth-transition" id="formContainer">
      <!-- Login Form -->
      <div id="loginSection" class="p-8">
        <h2 class="text-2xl font-bold text-center text-gray-800 mb-1">Welcome back</h2>
        <p class="text-center text-gray-600 mb-6">Sign in to continue your career journey</p>

        <form id="loginForm" class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1" for="loginEmail">Email address</label>
            <div class="relative">
              <input type="email" id="loginEmail" placeholder="you@example.com" required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" />
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1" for="loginPassword">Password</label>
            <div class="relative">
              <input type="password" id="loginPassword" placeholder="••••••••" required
                class="w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" />
              <button type="button" class="absolute password-toggle" onclick="togglePassword('loginPassword')">
                <i class="far fa-eye eye-icon"></i>
              </button>
            </div>
            <div class="flex justify-end mt-1">
              <a href="#" class="text-sm text-blue-600 hover:underline">Forgot password?</a>
            </div>
          </div>

          <button type="submit"
            class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-300 shadow-md flex justify-center items-center">
            <span id="loginBtnText">Sign In</span>
          </button>

          <p id="loginError" class="text-red-500 text-center text-sm mt-2 hidden"></p>
        </form>

        <div class="flex items-center my-6">
          <hr class="flex-grow border-gray-300" />
          <span class="mx-4 text-sm text-gray-500">or continue with</span>
          <hr class="flex-grow border-gray-300" />
        </div>

        <div class="grid grid-cols-2 gap-3">
          <button type="button" class="flex items-center justify-center space-x-2 border border-gray-300 py-2 rounded-lg hover:bg-gray-50 transition">
            <img src="https://img.icons8.com/color/24/google-logo.png" alt="Google" class="w-5 h-5" />
            <span>Google</span>
          </button>
          <button type="button" class="flex items-center justify-center space-x-2 border border-gray-300 py-2 rounded-lg hover:bg-gray-50 transition">
            <img src="https://img.icons8.com/fluency/24/microsoft.png" alt="Microsoft" class="w-5 h-5" />
            <span>Microsoft</span>
          </button>
        </div>

        <p class="text-center text-gray-600 mt-6">
          Don't have an account?
          <button type="button" onclick="toggleForm()" class="text-blue-600 hover:underline font-medium">Sign up</button>
        </p>
      </div>

      <!-- Signup Form -->
      <div id="signupSection" class="p-8 absolute top-0 left-0 w-full h-full bg-white hidden auth-transition">
        <button type="button" onclick="toggleForm()" class="flex items-center text-gray-600 hover:text-gray-900 mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
          </svg>
          Back
        </button>

        <h2 class="text-2xl font-bold text-center text-gray-800 mb-1">Create account</h2>
        <p class="text-center text-gray-600 mb-6">Start your career journey with us</p>

        <form id="signupForm" class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1" for="signupName">Full name</label>
            <input type="text" id="signupName" placeholder="John Doe" required
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1" for="signupEmail">Email address</label>
            <input type="email" id="signupEmail" placeholder="you@example.com" required
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1" for="signupPassword">Password</label>
            <div class="relative">
              <input type="password" id="signupPassword" placeholder="••••••••" required
                class="w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" />
              <button type="button" class="absolute password-toggle" onclick="togglePassword('signupPassword')">
                <i class="far fa-eye eye-icon"></i>
              </button>
            </div>
            <p class="text-xs text-gray-500 mt-1">At least 8 characters with a number and symbol</p>
          </div>

          <div class="flex items-start">
            <div class="flex items-center h-5">
              <input id="terms" type="checkbox" required
                class="w-4 h-4 border border-gray-300 rounded bg-gray-50 focus:ring-3 focus:ring-blue-300" />
            </div>
            <label for="terms" class="ml-2 text-sm text-gray-600">
              I agree to the <a href="#" class="text-blue-600 hover:underline">Terms</a> and <a href="#" class="text-blue-600 hover:underline">Privacy Policy</a>
            </label>
          </div>

          <button type="submit"
            class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-300 shadow-md flex justify-center items-center">
            <span id="signupBtnText">Create Account</span>
          </button>

          <p id="signupError" class="text-red-500 text-center text-sm mt-2 hidden"></p>
        </form>

        <div class="flex items-center my-6">
          <hr class="flex-grow border-gray-300" />
          <span class="mx-4 text-sm text-gray-500">or sign up with</span>
          <hr class="flex-grow border-gray-300" />
        </div>

        <div class="grid grid-cols-2 gap-3">
          <button type="button" class="flex items-center justify-center space-x-2 border border-gray-300 py-2 rounded-lg hover:bg-gray-50 transition">
            <img src="https://img.icons8.com/color/24/google-logo.png" alt="Google" class="w-5 h-5" />
            <span>Google</span>
          </button>
          <button type="button" class="flex items-center justify-center space-x-2 border border-gray-300 py-2 rounded-lg hover:bg-gray-50 transition">
            <img src="https://img.icons8.com/fluency/24/microsoft.png" alt="Microsoft" class="w-5 h-5" />
            <span>Microsoft</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Toggle between login and signup forms
    function toggleForm() {
      const loginSection = document.getElementById('loginSection');
      const signupSection = document.getElementById('signupSection');
      
      loginSection.classList.toggle('hidden');
      signupSection.classList.toggle('hidden');
      
      // Update the container height for smooth transition
      const authContainer = document.getElementById('authContainer');
      authContainer.style.height = signupSection.classList.contains('hidden') 
        ? loginSection.scrollHeight + 'px' 
        : signupSection.scrollHeight + 'px';
    }

    // Toggle password visibility
    function togglePassword(fieldId) {
      const passwordField = document.getElementById(fieldId);
      const eyeIcon = passwordField.nextElementSibling.querySelector('i');
      
      if (passwordField.type === 'password') {
        passwordField.type = 'text';
        eyeIcon.classList.replace('fa-eye', 'fa-eye-slash');
      } else {
        passwordField.type = 'password';
        eyeIcon.classList.replace('fa-eye-slash', 'fa-eye');
      }
    }

    // Handle form submissions and redirect
    document.addEventListener('DOMContentLoaded', function() {
      // Set initial container height
      const authContainer = document.getElementById('authContainer');
      if (authContainer) {
        authContainer.style.height = document.getElementById('loginSection').scrollHeight + 'px';
      }
      
      // Login form submission
      const loginForm = document.getElementById('loginForm');
      if (loginForm) {
        loginForm.addEventListener('submit', async function(e) {
          e.preventDefault();
          const email = document.getElementById('loginEmail').value.trim();
          const password = document.getElementById('loginPassword').value.trim();
          const errorElement = document.getElementById('loginError');
          const submitBtn = e.target.querySelector('button[type="submit"]');
          const btnText = submitBtn.querySelector('#loginBtnText');
          
          // Simple validation
          if (!email || !password) {
            errorElement.textContent = 'Please fill in all fields';
            errorElement.classList.remove('hidden');
            return;
          }
          
          // Show loading state
          const originalBtnText = btnText.textContent;
          submitBtn.disabled = true;
          btnText.innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Processing...';
          
          try {
            const response = await fetch('/api/login', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ email, password })
            });
            
            const data = await response.json();
            
            if (data.success) {
              // Redirect to home page using the URL from Flask
              window.location.href = data.redirect || '/';
            } else {
              errorElement.textContent = data.message || 'Login failed. Please check your credentials.';
              errorElement.classList.remove('hidden');
            }
          } catch (err) {
            errorElement.textContent = 'Network error. Please try again.';
            errorElement.classList.remove('hidden');
          } finally {
            // Reset button state
            submitBtn.disabled = false;
            btnText.textContent = originalBtnText;
          }
        });
      }
      
      // Signup form submission
      const signupForm = document.getElementById('signupForm');
      if (signupForm) {
        signupForm.addEventListener('submit', async function(e) {
          e.preventDefault();
          const name = document.getElementById('signupName').value.trim();
          const email = document.getElementById('signupEmail').value.trim();
          const password = document.getElementById('signupPassword').value.trim();
          const termsChecked = document.getElementById('terms').checked;
          const errorElement = document.getElementById('signupError');
          const submitBtn = e.target.querySelector('button[type="submit"]');
          const btnText = submitBtn.querySelector('#signupBtnText');
          
          // Validation
          if (!name || !email || !password) {
            errorElement.textContent = 'Please fill in all fields';
            errorElement.classList.remove('hidden');
            return;
          }
          
          if (!termsChecked) {
            errorElement.textContent = 'You must agree to the terms';
            errorElement.classList.remove('hidden');
            return;
          }
          
          if (password.length < 8) {
            errorElement.textContent = 'Password must be at least 8 characters';
            errorElement.classList.remove('hidden');
            return;
          }
          
          // Show loading state
          const originalBtnText = btnText.textContent;
          submitBtn.disabled = true;
          btnText.innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Creating account...';
          
          try {
            const response = await fetch('/api/signup', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ name, email, password })
            });
            
            const data = await response.json();
            
            if (data.success) {
              // Redirect to home page using the URL from Flask
              window.location.href = data.redirect || '/';
            } else {
              errorElement.textContent = data.message || 'Signup failed. Please try again.';
              errorElement.classList.remove('hidden');
            }
          } catch (err) {
            errorElement.textContent = 'Network error. Please try again.';
            errorElement.classList.remove('hidden');
          } finally {
            // Reset button state
            submitBtn.disabled = false;
            btnText.textContent = originalBtnText;
          }
        });
      }
    });
  </script>
</body>
</html>